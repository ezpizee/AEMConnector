<div id="commerce-alert-container"></div>
<div class="card mb-3" data-sly-use.commerce="com.ezpizee.aem.models.CommerceData">
    <div class="card-header bg-light">
        <div class="row">
            <div class="col-6"><h3 class="mb-0 mt-0">${properties.jcr:title}</h3></div>
            <div class="col-6" data-sly-test="${commerce.data.actions.add}">
                <div class="text-right">
                    <a href="${commerce.data.targetPage}.html" class="btn btn-primary"><i class="fas fa-plus-circle"></i>&nbsp;${'ADD' @ i18n}</a>
                </div>
            </div>
        </div>
    </div>
    <div class="card-body text-justify">
        <div id="commerce-items-commerce.data.list">
            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th data-sly-test="${commerce.data.fields.id}" class="small-col">${commerce.data.fields.id @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.name}" class="name">${commerce.data.fields.name @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.name_with_depth}" class="name">${commerce.data.fields.name_with_depth @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.internal_name}" class="name">${commerce.data.fields.internal_name @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.public_name}" class="name">${commerce.data.fields.public_name @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.description}" class="description">${commerce.data.fields.description @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.parent}">${commerce.data.fields.parent @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.addr_street}">${commerce.data.fields.addr_street @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.addr_city}">${commerce.data.fields.addr_city @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.addr_province}">${commerce.data.fields.addr_province @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.addr_country}">${commerce.data.fields.addr_country @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.addr_postalcode}">${commerce.data.fields.addr_postalcode @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.email}">${commerce.data.fields.email @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.url}">${commerce.data.fields.url @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.telephone}">${commerce.data.fields.telephone @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.telephone_type}">${commerce.data.fields.telephone_type @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.parent_name}">${commerce.data.fields.parent_name @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.tax_code}">${commerce.data.fields.tax_code @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.tax_rate}">${commerce.data.fields.tax_rate @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.start_date}">${commerce.data.fields.start_date @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.end_date}">${commerce.data.fields.end_date @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.offer_type}">${commerce.data.fields.offer_type @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.percentage_off}">${commerce.data.fields.percentage_off @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.published}" class="small-col">${commerce.data.fields.published @ i18n}</th>
                    <th data-sly-test="${commerce.data.fields.action}">${'ACTION' @ i18n}</th>
                </tr>
                </thead>
                <tbody data-sly-test="${commerce.data.list}" data-sly-list="${commerce.data.list}">
                <tr>
                    <td data-sly-test="${commerce.data.fields.id}">${item.id}</td>
                    <td data-sly-test="${commerce.data.fields.name}">
                        <sly data-sly-test="${item.is_protected}">
                            <sly data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</sly>
                            <sly data-sly-test="${item.name != 'ROOT'}">${item.name}</sly>
                        </sly>
                        <sly data-sly-test="${!item.is_protected}">
                            <sly data-sly-test="${commerce.data.actions.edit}">
                                <a href="${commerce.data.targetPage}?edit_id=${item.edit_id||item.id}">
                                    <sly data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</sly>
                                    <sly data-sly-test="${item.name != 'ROOT'}">${item.name}</sly>
                                </a>
                            </sly>
                            <sly data-sly-test="${!commerce.data.actions.edit}">
                                <sly data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</sly>
                                <sly data-sly-test="${item.name != 'ROOT'}">${item.name}</sly>
                            </sly>
                        </sly>
                    </td>
                    <td data-sly-test="${commerce.data.fields.name_with_depth}">
                        <span class="depth" data-sly-test="${item.is_protected}">
                            <span class="level-${item.depth}" data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</span>
                            <span class="level-${item.depth}" data-sly-test="${item.name != 'ROOT'}">${item.name}</span>
                        </span>
                        <span data-sly-test="${!item.is_protected}" class="depth level-${item.depth}">
                            <a href="${commerce.data.targetPage}?edit_id=${item.edit_id||item.id}" data-sly-test="${commerce.data.actions.edit}">
                                <sly data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</sly>
                                <sly data-sly-test="${item.name != 'ROOT'}">${item.name}</sly>
                            </a>
                            <sly data-sly-test="${!commerce.data.actions.edit}">
                                <sly data-sly-test="${item.name == 'ROOT'}">${'ROOT' @ i18n}</sly>
                                <sly data-sly-test="${item.name != 'ROOT'}">${item.name}</sly>
                            </sly>
                        </span>
                    </td>
                    <td data-sly-test="${commerce.data.fields.internal_name}">
                        <sly data-sly-test="${item.is_protected}">${item.internal_name}</sly>
                        <sly data-sly-test="${!item.is_protected}">
                            <a data-sly-test="${commerce.data.actions.edit}" href="${commerce.data.targetPage}?edit_id=${item.edit_id||item.id}">
                                ${item.internal_name}
                            </a>
                            <sly data-sly-test="${commerce.data.actions.edit}">${item.internal_name}</sly>
                        </sly>
                    </td>
                    <td data-sly-test="${commerce.data.fields.public_name}">
                        <sly data-sly-test="${item.is_protected}">${item.public_name}</sly>
                        <sly data-sly-test="${!item.is_protected}">
                            <a data-sly-test="${commerce.data.actions.edit}" href="${commerce.data.targetPage}?edit_id=${item.edit_id||item.id}">
                                ${item.public_name}
                            </a>
                            <sly data-sly-test="${commerce.data.actions.edit}">${item.public_name}</sly>
                        </sly>
                    </td>
                    <td data-sly-test="${commerce.data.fields.description}" class="desc-more-less">${item.description @ context='html'}</td>
                    <td data-sly-test="${commerce.data.fields.parent}">${item.parent}</td>
                    <td data-sly-test="${commerce.data.fields.addr_street}">${item.addr_street}</td>
                    <td data-sly-test="${commerce.data.fields.addr_city}">${item.addr_city}</td>
                    <td data-sly-test="${commerce.data.fields.addr_province}">${item.addr_province}</td>
                    <td data-sly-test="${commerce.data.fields.addr_country}">${item.addr_country}</td>
                    <td data-sly-test="${commerce.data.fields.addr_postalcode}">${item.addr_postalcode}</td>
                    <td data-sly-test="${commerce.data.fields.email}">${item.email}</td>
                    <td data-sly-test="${commerce.data.fields.url}">${item.url}</td>
                    <td data-sly-test="${commerce.data.fields.telephone}">${item.telephone}</td>
                    <td data-sly-test="${commerce.data.fields.telephone_type}">${item.telephone_type}</td>
                    <td data-sly-test="${commerce.data.fields.parent_name}">${item.parent.name}</td>
                    <td data-sly-test="${commerce.data.fields.tax_code}">${item.tax_code}</td>
                    <td data-sly-test="${commerce.data.fields.tax_rate}">${item.tax_rate}%</td>
                    <td data-sly-test="${commerce.data.fields.start_date}" align="center">${item.start_date}</td>
                    <td data-sly-test="${commerce.data.fields.end_date}" align="center">${item.end_date}</td>
                    <td data-sly-test="${commerce.data.fields.percentage_off}">${item.percentage_off}</td>
                    <td data-sly-test="${commerce.data.fields.offer_type}" align="center">${item.offer_type @ i18n}</td>
                    <td data-sly-test="${commerce.data.fields.published}" align="center">${item.published}</td>
                    <td data-sly-test="${commerce.data.fields.action}" class="${commerce.data.actions.delete?'small-col-2':'small-col-1'}" align="center">
                        <sly data-sly-test="${!item.is_protected}">
                            <a data-sly-test="${commerce.data.actions.edit}"
                               href="${commerce.data.targetPage}.html?edit_id=${item.edit_id||item.id}"
                               class="btn btn-primary btn-sm"><i class="fa fa-edit"></i>&nbsp;${'EDIT' @ i18n}</a>
                            &nbsp;
                            <a data-sly-test="${commerce.data.actions.delete}"
                               href="javascript:void(0)"
                               onclick="WC.delete('${commerce.data.delete_api_endpoint @ context='attribute'}', '${item.edit_id||item.id @ context='attribute'}')"
                               class="btn btn-primary btn-sm"><i class="fas fa-times-circle"></i>&nbsp;${'DELETE' @ i18n}</a>
                        </sly>
                    </td>
                </tr>
                </tbody>
                <tbody data-sly-test="${!commerce.data.list}">
                <tr><td colspan="${commerce.data.fields.size}">${'NO_RESULTS' @ i18n}</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>WC.utilities.applyMoreLess('.desc-more-less')</script>